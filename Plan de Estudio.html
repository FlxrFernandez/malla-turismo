<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Interactiva - Lic. en Turismo</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      padding: 2rem;
    }
    h1 {
      text-align: center;
    }
    #progreso {
      text-align: center;
      margin: 1rem 0 2rem;
      font-weight: bold;
    }
    .anio {
      margin-bottom: 2rem;
    }
    .materia {
      display: inline-block;
      margin: 5px;
      padding: 10px 15px;
      border-radius: 8px;
      color: white;
      background: #3d348b;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .materia.anio2 { background: #7678ed; }
    .materia.anio3 { background: #f7b801; color: black; }
    .materia.anio4 { background: #f18701; }

    .materia.aprobada {
      background: #c2f0c2 !important;
      text-decoration: line-through;
      color: #555 !important;
    }
    .materia.bloqueada {
      background: #eee !important;
      color: #aaa !important;
      cursor: not-allowed;
    }
    .materia:hover::after {
      content: attr(data-info);
      display: block;
      position: absolute;
      background: #fff;
      color: #000;
      border: 1px solid #ccc;
      padding: 5px;
      font-size: 0.8em;
      max-width: 200px;
      z-index: 10;
    }
    #acciones {
      text-align: center;
      margin-top: 2rem;
    }
    button {
      margin: 0 10px;
      padding: 8px 15px;
      border-radius: 5px;
      border: none;
      background: #f35b04;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #d44a00;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Lic. en Turismo (UNLaR)</h1>
  <div id="progreso"></div>
  <div id="malla"></div>
  <div id="acciones">
    <button onclick="guardarProgreso()">üíæ Guardar</button>
    <button onclick="cargarProgreso()">üìÇ Cargar</button>
    <button onclick="descargarProgreso()">‚¨áÔ∏è Exportar</button>
    <input type="file" id="importarArchivo" accept=".json" style="display:none" onchange="importarProgreso(event)">
    <button onclick="document.getElementById('importarArchivo').click()">‚¨ÜÔ∏è Importar</button>
  </div>

  <script>
    const materias = {
      "SLT85": { nombre: "Derecho aplicado al turismo", anio: 1, correlativas: [] },
      "SLT84": { nombre: "Ingl√©s I", anio: 1, correlativas: [] },
      "SLT87": { nombre: "Principios de administraci√≥n", anio: 1, correlativas: [] },
      "SLT86": { nombre: "Procesos hist√≥ricos mundiales", anio: 1, correlativas: [] },
      "SLT81": { nombre: "Espacios geogr√°ficos de Arg. y Am√©rica", anio: 1, correlativas: [] },
      "SLT82": { nombre: "Expresi√≥n oral y escrita", anio: 1, correlativas: [] },
      "SLT83": { nombre: "Fund. econ√≥micos aplic. al turismo", anio: 1, correlativas: [] },
      "SLT80": { nombre: "Teor√≠a y t√©cnica del turismo", anio: 1, correlativas: [] },
      "SLT92": { nombre: "Legislaci√≥n tur√≠stica", anio: 2, correlativas: ["SLT85"] },
      "SLT94": { nombre: "M√©todos y t√©cnicas de investigaci√≥n", anio: 2, correlativas: ["SLT82"] },
      "SLT93": { nombre: "Servicio de transporte", anio: 2, correlativas: ["SLT80"] },
      "SLT95": { nombre: "Sociolog√≠a tur√≠stica", anio: 2, correlativas: ["SLT80"] },
      "SLT97": { nombre: "Fund. contabilidad aplicada al turismo", anio: 2, correlativas: [] },
      "SLT98": { nombre: "Introducci√≥n a la comercializaci√≥n", anio: 2, correlativas: [] },
      "SLT99": { nombre: "Psicolog√≠a social y din√°mica grupal", anio: 2, correlativas: [] },
      "SLT96": { nombre: "TICs aplicadas al turismo", anio: 2, correlativas: [] },
      "SLT88": { nombre: "Esp. geogr√°ficos de Europa, Asia, √Åfrica...", anio: 2, correlativas: ["SLT81"] },
      "SLT89": { nombre: "Gesti√≥n alojamiento y gastron√≥mico", anio: 2, correlativas: ["SLT87"] },
      "SLT90": { nombre: "Ingl√©s II", anio: 2, correlativas: ["SLT84"] },
      "SLT91": { nombre: "Pr√°ctica pre profesional I", anio: 2, correlativas: ["SLT80"] },
      "LT106": { nombre: "Gesti√≥n de estad√≠stica en turismo", anio: 3, correlativas: [] },
      "LT104": { nombre: "Ingl√©s III", anio: 3, correlativas: ["SLT90"] },
      "LT105": { nombre: "Pol√≠ticas tur√≠sticas y adm. p√∫blica", anio: 3, correlativas: ["SLT92"] },
      "LT107": { nombre: "Proc. hist√≥ricos arg. y riojanos", anio: 3, correlativas: ["SLT86"] },
      "LT110": { nombre: "Antropolog√≠a cultural", anio: 3, correlativas: [] },
      "LT109": { nombre: "Recursos humanos", anio: 3, correlativas: [] },
      "LT108": { nombre: "Sistemas de calidad", anio: 3, correlativas: [] },
      "LT102": { nombre: "Investigaci√≥n de mercados tur√≠sticos", anio: 3, correlativas: [] },
      "LT101": { nombre: "Gesti√≥n de agencias de viajes", anio: 3, correlativas: [] },
      "LT100": { nombre: "Planeamiento y desarrollo tur√≠stico", anio: 3, correlativas: [] },
      "LT103": { nombre: "Pr√°ctica pre profesional II", anio: 3, correlativas: ["SLT91"] },
      "LT116": { nombre: "Investigaci√≥n aplicada al turismo", anio: 4, correlativas: ["LT102"] },
      "LT117": { nombre: "√âtica y deontolog√≠a profesional", anio: 4, correlativas: [] },
      "LT118": { nombre: "Seminario de trabajo final", anio: 4, correlativas: ["LT116"] },
      "LT112": { nombre: "Formulaci√≥n y evaluaci√≥n de proyectos", anio: 4, correlativas: [] },
      "LT114": { nombre: "Ingl√©s IV", anio: 4, correlativas: ["LT104"] },
      "LT111": { nombre: "Org. y adm. de empresas tur√≠sticas", anio: 4, correlativas: ["LT105"] },
      "LT113": { nombre: "Marketing para empresas y destinos", anio: 4, correlativas: [] },
      "LT115": { nombre: "Pr√°ctica pre profesional III", anio: 4, correlativas: ["LT103"] }
    };

    let estadoMaterias = JSON.parse(localStorage.getItem("estadoMaterias")) || {};
    const malla = document.getElementById("malla");
    const progreso = document.getElementById("progreso");

    for (let anio = 1; anio <= 4; anio++) {
      const div = document.createElement("div");
      div.className = "anio";
      div.innerHTML = `<h2>A√±o ${anio}</h2>`;
      Object.entries(materias).forEach(([codigo, mat]) => {
        if (mat.anio === anio) {
          const btn = document.createElement("div");
          btn.className = `materia anio${anio}`;
          btn.textContent = mat.nombre;
          btn.dataset.codigo = codigo;
          btn.setAttribute("data-info", `C√≥digo: ${codigo}\nA√±o: ${mat.anio}\nCorrelativas: ${mat.correlativas.join(", ") || "Ninguna"}`);
          btn.addEventListener("click", () => toggleAprobacion(codigo));
          div.appendChild(btn);
        }
      });
      malla.appendChild(div);
    }

    function toggleAprobacion(codigo) {
      estadoMaterias[codigo] = !estadoMaterias[codigo];
      guardarEnLocalStorage();
      renderMalla();
    }

    function renderMalla() {
      const total = Object.keys(materias).length;
      const aprobadas = Object.values(estadoMaterias).filter(Boolean).length;
      progreso.textContent = `‚úÖ ${aprobadas} de ${total} materias aprobadas (${Math.round((aprobadas / total) * 100)}%)`;
      document.querySelectorAll(".materia").forEach(el => {
        const cod = el.dataset.codigo;
        el.classList.remove("aprobada", "bloqueada");
        if (estadoMaterias[cod]) {
          el.classList.add("aprobada");
        } else {
          const correlativas = materias[cod].correlativas;
          const bloqueada = correlativas.some(c => !estadoMaterias[c]);
          if (bloqueada) {
            el.classList.add("bloqueada");
          }
        }
      });
    }

    function guardarEnLocalStorage() {
      localStorage.setItem("estadoMaterias", JSON.stringify(estadoMaterias));
    }

    function guardarProgreso() {
      guardarEnLocalStorage();
      alert("¬°Progreso guardado!");
    }

    function cargarProgreso() {
      estadoMaterias = JSON.parse(localStorage.getItem("estadoMaterias")) || {};
      renderMalla();
    }

    function descargarProgreso() {
      const blob = new Blob([JSON.stringify(estadoMaterias)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "progreso_turismo.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importarProgreso(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        estadoMaterias = JSON.parse(e.target.result);
        guardarEnLocalStorage();
        renderMalla();
      };
      reader.readAsText(file);
    }

    renderMalla();
  </script>
</body>
</html>
